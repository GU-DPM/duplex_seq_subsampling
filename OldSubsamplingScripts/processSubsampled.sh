#~ SampID=("3062467A1" "3062467D1" "3062583A1" "3062583D1" "3062698A1" "3062698D1" "3070030A1" "3070030D1" "3070052A1" "3070052D1" "3070157A1" "3070157D1" "3070354A1" "3070354D1" "3070570A1" "3070570D1" "3070611A1" "3070611D1" "3070686A1" "3070686D1" "3070964A1" "3070964D1" "3071007A1" "  " "3071022A1" "3071022D1" "3071134A1" "3071134D1")
#~ file1=("/Volumes/brendan-2/20171013_Proc/ATTGAG/20171013_BN18.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/ACGCTC/20171013_BN17.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/GCTCGG/20171013_BN21.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/ACCACT/20171013_BN15.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/ACATTG/20171013_BN27.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/CCATCC/20171013_BN25.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/TATCAG/20171013_BN22.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/AACAAC/20171013_BN16.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/AACCGA/20171013_BN28.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/CTGGCA/20171013_BN20.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN41/BN41_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN34/BN34_postMerge.bam" "/Volumes/brendan-2/20171013_Proc/CCGAAG/20171013_BN19.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/GACAGT/20171013_BN26.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN31/BN31_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN42/BN42_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN38/BN38_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN32/BN32_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN33/BN33_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN35/BN35_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN37/BN37_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN44/BN44_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN40/BN40_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN36/BN36_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN39/BN39_postMerge.bam" "/Volumes/brendan-2/MergedProcessing_col-006/BN43/BN43_postMerge.bam" "/Volumes/brendan-2/col_010/GAGTTA/20171215_BN67.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/AACTCA/20171013_BN23.dcs.filt.no_overlap.bam")
#~ file2=("/Volumes/brendan-2/col_010/CCGACA/20171215_BN66.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/CCATCC/20171215_BN54.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/CAACCA/20171215_BN59.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/ACATTG/20171215_BN56.dcs.filt.no_overlap.bam" "" "" "/Volumes/brendan-2/col_010/CCGTGA/20171215_BN60.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/AACAAC/20171215_BN45.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/AGCCAT/20171215_BN65.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/GCTCGG/20171215_BN50.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/ATTGAG/20171215_BN47.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/CTGGCA/20171215_BN49.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/ACGCTC/20171215_BN46.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/AAGAGA/20171215_BN64.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/AACCGA/20171215_BN57.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/AGCACC/20171215_BN53.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/GAATCT/20171215_BN61.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/CCGAAG/20171215_BN48.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/ACCACT/20171215_BN44.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/AACGCT/20171215_BN69.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/GGAGAA/20171215_BN62.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/AACTCA/20171215_BN52.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/ACGTAT/20171215_BN58.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/TATCAG/20171215_BN51.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/TCCGTC/20171215_BN63.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/CAGATC/20171215_BN68.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/20171013_Proc/AGCACC/20171013_BN24.dcs.filt.no_overlap.bam" "/Volumes/brendan-2/col_010/GACAGT/20171215_BN55.dcs.filt.no_overlap.bam")


#~ SampID=(3062467A1 3062467D1 3062583A1 3062583D1 3070030A1 3070030D1 3070052A1 3070052D1 3070157A1 3070157D1 3070354A1 3070354D1 3070570A1 3070570D1 3070611A1 3070611D1 3070686A1 3070686D1 3070964A1 3070964D1 3071007A1 3071007D1 3071022A1 3071022D1 3071134A1 3071134D1)
#~ file1=(/Volumes/brendan-2/20171013_Proc/ATTGAG/20171013_BN18.dcs.filt.no_overlap.bam /Volumes/brendan-2/20171013_Proc/ACGCTC/20171013_BN17.dcs.filt.no_overlap.bam /Volumes/brendan-2/20171013_Proc/GCTCGG/20171013_BN21.dcs.filt.no_overlap.bam /Volumes/brendan-2/20171013_Proc/ACCACT/20171013_BN15.dcs.filt.no_overlap.bam /Volumes/brendan-2/20171013_Proc/TATCAG/20171013_BN22.dcs.filt.no_overlap.bam /Volumes/brendan-2/20171013_Proc/AACAAC/20171013_BN16.dcs.filt.no_overlap.bam /Volumes/brendan-2/20171013_Proc/AACCGA/20171013_BN28.dcs.filt.no_overlap.bam /Volumes/brendan-2/20171013_Proc/CTGGCA/20171013_BN20.dcs.filt.no_overlap.bam /Volumes/brendan-2/MergedProcessing_col-006/BN41/BN41_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN34/BN34_postMerge.bam /Volumes/brendan-2/20171013_Proc/CCGAAG/20171013_BN19.dcs.filt.no_overlap.bam /Volumes/brendan-2/20171013_Proc/GACAGT/20171013_BN26.dcs.filt.no_overlap.bam /Volumes/brendan-2/MergedProcessing_col-006/BN31/BN31_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN42/BN42_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN38/BN38_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN32/BN32_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN33/BN33_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN35/BN35_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN37/BN37_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN44/BN44_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN40/BN40_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN36/BN36_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN39/BN39_postMerge.bam /Volumes/brendan-2/MergedProcessing_col-006/BN43/BN43_postMerge.bam /Volumes/brendan-2/col_010/GAGTTA/20171215_BN67.dcs.filt.no_overlap.bam /Volumes/brendan-2/20171013_Proc/AACTCA/20171013_BN23.dcs.filt.no_overlap.bam)
#~ file2=(/Volumes/brendan-2/col_010/CCGACA/20171215_BN66.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/CCATCC/20171215_BN54.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/CAACCA/20171215_BN59.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/ACATTG/20171215_BN56.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/CCGTGA/20171215_BN60.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/AACAAC/20171215_BN45.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/AGCCAT/20171215_BN65.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/GCTCGG/20171215_BN50.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/ATTGAG/20171215_BN47.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/CTGGCA/20171215_BN49.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/ACGCTC/20171215_BN46.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/AAGAGA/20171215_BN64.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/AACCGA/20171215_BN57.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/AGCACC/20171215_BN53.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/GAATCT/20171215_BN61.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/CCGAAG/20171215_BN48.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/ACCACT/20171215_BN44.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/AACGCT/20171215_BN69.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/GGAGAA/20171215_BN62.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/AACTCA/20171215_BN52.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/ACGTAT/20171215_BN58.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/TATCAG/20171215_BN51.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/TCCGTC/20171215_BN63.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/CAGATC/20171215_BN68.dcs.filt.no_overlap.bam /Volumes/brendan-2/20171013_Proc/AGCACC/20171013_BN24.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/GACAGT/20171215_BN55.dcs.filt.no_overlap.bam)

#~ SampID=(3071134A1 3071134D1)
#~ file1=(/Volumes/brendan-2/col_010/GAGTTA/20171215_BN67.dcs.filt.no_overlap.bam /Volumes/brendan-2/20171013_Proc/AACTCA/20171013_BN23.dcs.filt.no_overlap.bam)
#~ file2=(/Volumes/brendan-2/20171013_Proc/AGCACC/20171013_BN24.dcs.filt.no_overlap.bam /Volumes/brendan-2/col_010/GACAGT/20171215_BN55.dcs.filt.no_overlap.bam)

props="0 1 2 3"
samp=$1

set -e
set -o pipefail
set -u
set -x

for i in $props; do
	#~ echo ${SampID[$i]}
	#~ mkdir ${SampID[$i]}
	#~ cd ${SampID[$i]}
	#~ samtools merge ${SampID[$i]}_merge_braf.bam ${file2[$i]} ${file1[$i]}
	##~ samtools reheader ~/bioinformatics/reference/human/hg19/hg19.dict ${SampID[$i]}_merge_braf.bam > ${SampID[$i]}_merge_braf.rehead.bam
	samtools sort ${samp}_s${i}.bam > ${samp}_s${i}.sort.bam
	samtools index ${samp}_s${i}.sort.bam
	
	samtools mpileup -B -A -d 500000 -Q 0 \
	-f ~/bioinformatics/reference/human/hg19/hg19.fa \
	${samp}_s${i}.sort.bam \
	> ${samp}_s${i}.pileup
	
	python ~/bioinformatics/dcs/kohrnDCS0.1.0/DCS/filter_pileup.py \
	~/bioinformatics/targets/pol_de.bed \
	${samp}_s${i}.pileup \
	${samp}_s${i}.region.pileup \
	N

	java -jar ~/bioinformatics/programs/picard-2.10.1/picard.jar CollectHsMetrics \
	I=${samp}_s${i}.sort.bam \
	R=~/bioinformatics/reference/human/hg19/hg19.fa \
	TARGET_INTERVALS=/Users/loeblabm11/bioinformatics/targets/pol_de.interval_list \
	BAIT_INTERVALS=/Users/loeblabm11/bioinformatics/targets/pol_de.interval_list \
	O=${samp}_s${i}.hs_metrics.txt \
	PER_BASE_COVERAGE=${samp}_s${i}.per_base_coverage.txt

	python ~/bioinformatics/dcs/kohrnDCS0.1.0/DCS/CountMuts.py -d 100 \
	-c 0 \
	-C 0.1 \
	-u \
	-i ${samp}_s${i}.region.pileup \
	-o ${samp}_s${i}.region.c0-0.1.d100.countmuts.txt \
	-n 1
	
	python ~/bioinformatics/dcs/kohrnDCS0.1.0/DCS/mut-position.py \
	-i ${samp}_s${i}.region.pileup \
	-o ${samp}_s${i}.region.c0-1.d1.mutpos \
	-d 1 \
	-c 0  \
	-C 1 \
	-n 1
	echo "Retrieving statistics"
	python ../retrieveSummary3.py --in ${samp}_s${i} >> ../${samp}_nr_summary.csv
	#~ cd ../
done
